create or replace view DEV_RIVERSIDE_TRUSTED_DATASETS.ENTERPRISE_PLATFORM_SERVICES.VW_MDR_CUSTOMERS(
	MDR_CUSTOMER_ID COMMENT 'Unique Customer id from MDR Building view',
	MDR_CUSTOMER_NAME COMMENT 'Customer name from MDR Building view',
	MDR_CUSTOMER_ADDRESS COMMENT 'Customer address from MDR Building view',
	MDR_CUSTOMER_CITY COMMENT 'Customer city from MDR Building view',
	MDR_CUSTOMER_COUNTY COMMENT 'Customer county from MDR Building view',
	MDR_CUSTOMER_STATE COMMENT 'Customer state from MDR Building view',
	MDR_CUSTOMER_ZIPCODE COMMENT 'Customer zip code from MDR Building view',
	MDR_CUSTOMER_COUNTRY COMMENT 'Customer country from MDR Building view',
	MDR_CUSTOMER_INSTITUTION_SPECIFICATION COMMENT 'Customer institution specification from MDR Building view',
	MDR_CUSTOMER_INSTITUTION_TYPE COMMENT 'Customer institution type from MDR Building view',
	MDR_CUSTOMER_METRO_CODE COMMENT 'Customer metro code from MDR Building view',
	MDR_CUSTOMER_INSTITUTION_EDUCATION_LEVEL COMMENT 'Customer id from MDR Building view',
	MDR_CUSTOMER_LATITUDE COMMENT 'Customer latitude from MDR Building view',
	MDR_CUSTOMER_LONGITUDE COMMENT 'Customer longitude from MDR Building view',
	MDR_CUSTOMER_STUDENT_TEACHER_RATIO_COUNT COMMENT 'Customer student to teacher count ratio from MDR Building view',
	MDR_CUSTOMER_ENROLLED_STUDENT_COUNT COMMENT 'Customer enrolled student count from MDR Building view',
	MDR_CUSTOMER_SCHOOL_CLASSROOM_COUNT COMMENT 'Customer school classroom count from MDR Building view',
	MDR_CUSTOMER_MATERIALS_PER_PUPIL_RNG COMMENT 'Customer materials per pupil rng from MDR Building view',
	MDR_CUSTOMER_EXPENDITURE_PER_PUPIL_RNG COMMENT 'Customer expenditure per pupil rng from MDR Building view',
	MDR_CUSTOMER_INSTRUCTIONAL_MATERIAL_EXPENDITURE_AMT COMMENT 'Customer instructional material expenditure amount from MDR Building view',
	MDR_CUSTOMER_CURRENT_EXPENDITURE_AMT COMMENT 'Customer current expenditure amount from MDR Building view',
	MDR_CUSTOMER_SCHOOL_YEAR_OPENING_RNG COMMENT 'Customer school year opening rng from MDR Building view',
	MDR_CUSTOMER_SCHOOL_YEAR_CLOSING_RNG COMMENT 'Customer school year closing rng from MDR Building view',
	MDR_CUSTOMER_STUDENT_CAUCASIAN_PCT COMMENT 'Customer student caucasian pct from MDR Building view',
	MDR_CUSTOMER_STUDENT_AFRICAN_AMERICAN_PCT COMMENT 'Customer STUDENT AFRICAN AMERICAN PCT from MDR Building view',
	MDR_CUSTOMER_STUDENT_NATIVE_AMERICAN_PCT COMMENT 'Customer STUDENT NATIVE AMERICAN PCT from MDR Building view',
	MDR_CUSTOMER_STUDENT_ASIAN_PCT COMMENT 'Customer STUDENT ASIAN PCT from MDR Building view',
	MDR_CUSTOMER_STUDENT_HISPANIC_PCT COMMENT 'Customer STUDENT HISPANIC PCT from MDR Building view',
	MDR_CUSTOMER_POVERTY_LEVEL_RNG COMMENT 'Customer POVERTY LEVEL RNG from MDR Building view',
	MDR_CUSTOMER_ACTUAL_POVERTY_PCT COMMENT 'Customer ACTUAL POVERTY PCT from MDR Building view',
	MDR_CUSTOMER_12TH_GRADE_STUDENT_COLLEGE_BOUND_PCT COMMENT 'Customer 12TH GRADE STUDENT COLLEGE BOUND PCT from MDR Building view',
	MDR_CUSTOMER_HOUSEHOLD_INCOME_RNG COMMENT 'Customer HOUSEHOLD INCOMERNG from MDR Building view',
	MDR_CUSTOMER_CAREER_AND_TECH_ED_OFFERED_IND COMMENT 'Customer CAREER AND TECH ED OFFERED IND from MDR Building view',
	MDR_CUSTOMER_ADULT_EDUCATION_OFFERED_IND COMMENT 'Customer ADULT EDUCATION OFFERED IND from MDR Building view',
	MDR_CUSTOMER_SPECIAL_EDUCATION_OFFERED_IND COMMENT 'Customer SPECIAL EDUCATION OFFERED IND from MDR Building view',
	MDR_CUSTOMER_CHARTER_SCHOOL_IND COMMENT 'Customer CHARTER SCHOOL IND from MDR Building view',
	MDR_CUSTOMER_MAGNET_SCHOOL_OR_PROGRAMS_IND COMMENT 'Customer MAGNET SCHOOL OR PROGRAMS IND from MDR Building view',
	MDR_CUSTOMER_ADV_PLACEMENT_COURSES_OFFERED_IND COMMENT 'Customer ADV PLACEMENT COURSES OFFERED IND from MDR Building view',
	MDR_CUSTOMER_ADV_PLACEMENT_MATH_OFFERED_IND COMMENT 'Customer ADV PLACEMENT MATH OFFERED IND from MDR Building view',
	MDR_CUSTOMER_ADV_PLACEMENT_SCIENCE_OFFERED_IND COMMENT 'Customer ADV PLACEMENT SCIENCE OFFERED IND from MDR Building view',
	MDR_CUSTOMER_ADV_PLACEMENT_SOCIAL_STUDIES_OFFERED_IND COMMENT 'Customer ADV PLACEMENT SOCIAL STUDIES OFFERED IND from MDR Building view',
	MDR_CUSTOMER_ADV_PLACEMENT_ENGLISH_OFFERED_IND COMMENT 'Customer ADV PLACEMENT ENGLISH OFFERED IND from MDR Building view',
	MDR_CUSTOMER_ADV_PLACEMENT_FINE_ARTS_OFFERED_IND COMMENT 'Customer ADV PLACEMENT FINE ARTS OFFERED IND from MDR Building view',
	MDR_CUSTOMER_ADV_PLACEMENT_FOREIGN_LANG_OFFERED_IND COMMENT 'Customer ADV PLACEMENT FOREIGN LANG OFFERED IND from MDR Building view',
	MDR_CUSTOMER_ADV_PLACEMENT_COMP_SCI_OFFERED_IND COMMENT 'Customer ADV PLACEMENT COMP SCI OFFERED IND from MDR Building view',
	MDR_CUSTOMER_ALTERNATIVE_SCHOOL_OR_PROGRAM_OFFERED COMMENT 'Customer ALTERNATIVE SCHOOL OR PROGRAM OFFERED from MDR Building view',
	MDR_CUSTOMER_BEFORE_AFTER_SCHOOL_PROGRAMS_IND COMMENT 'Customer BEFORE AFTER SCHOOL PROGRAMS IND from MDR Building view',
	MDR_CUSTOMER_OPEN_YEAR_ROUND_IND COMMENT 'Customer OPEN YEAR ROUND IND from MDR Building view',
	MDR_CUSTOMER_BILINGUAL_EDUCATION_IND COMMENT 'Customer BILINGUAL EDUCATION IND from MDR Building view',
	MDR_CUSTOMER_SUBSTANCE_ABUSE_PROGRAM_OFFERED_IND COMMENT 'Customer SUBSTANCE ABUSE PROGRAM OFFERED IND from MDR Building view',
	MDR_CUSTOMER_CENTER_PROVIDES_MEDIA_SERVICES_IND COMMENT 'Customer CENTER PROVIDES MEDIA SERVICES IND from MDR Building view',
	MDR_CUSTOMER_CENTER_PROVIDES_TECHNOLOGY_SERVICES_IND COMMENT 'Customer CENTER PROVIDES TECHNOLOGY SERVICES IND from MDR Building view',
	MDR_CUSTOMER_SCHOOLWIDE_TITLE_1_PROGRAM_IND COMMENT 'Customer SCHOOL WIDE TITLE 1 PROGRAM IND from MDR Building view',
	MDR_CUSTOMER_TITLE_1_$_PER_STUDENT_RNG COMMENT 'Customer TITLE 1 $ PER STUDENT RNG from MDR Building view',
	MDR_CUSTOMER_TITLE_1_DISTRICT_ALLOCATION_$AMT COMMENT 'Customer TITLE 1 DISTRICT ALLOCATION $ AMOUNT from MDR Building view',
	MDR_CUSTOMER_INSTITUTION_WEB_ADDRESS_URL COMMENT 'Customer INSTITUTION WEB ADDRESS URL from MDR Building view',
	MDR_CUSTOMER_CLASSROOM_TEACHER_CNT COMMENT 'Customer CLASSROOM TEACHER CNT from MDR Building view',
	MDR_CUSTOMER_STUDENT_GRADE_PK_CNT COMMENT 'Customer STUDENT GRADE PK CNT from MDR Building view',
	MDR_CUSTOMER_STUDENT_GRADE_K_CNT COMMENT 'Customer STUDENT GRADE K CNT from MDR Building view',
	MDR_CUSTOMER_STUDENT_GRADE_1_CNT COMMENT 'Customer STUDENT GRADE 1 CNT from MDR Building view',
	MDR_CUSTOMER_STUDENT_GRADE_2_CNT COMMENT 'Customer STUDENT GRADE 2 CNT from MDR Building view',
	MDR_CUSTOMER_STUDENT_GRADE_3_CNT COMMENT 'Customer STUDENT GRADE 3 CNT from MDR Building view',
	MDR_CUSTOMER_STUDENT_GRADE_4_CNT COMMENT 'Customer STUDENT GRADE 4 CNT from MDR Building view',
	MDR_CUSTOMER_STUDENT_GRADE_5_CNT COMMENT 'Customer STUDENT GRADE 5 CNT from MDR Building view',
	MDR_CUSTOMER_STUDENT_GRADE_6_CNT COMMENT 'Customer STUDENT GRADE 6 CNT from MDR Building view',
	MDR_CUSTOMER_STUDENT_GRADE_7_CNT COMMENT 'Customer STUDENT GRADE 7 CNT from MDR Building view',
	MDR_CUSTOMER_STUDENT_GRADE_8_CNT COMMENT 'Customer STUDENT GRADE 8 CNT from MDR Building view',
	MDR_CUSTOMER_STUDENT_GRADE_9_CNT COMMENT 'Customer STUDENT GRADE 9 CNT from MDR Building view',
	MDR_CUSTOMER_STUDENT_GRADE_10_CNT COMMENT 'Customer STUDENT GRADE 10 CNT from MDR Building view',
	MDR_CUSTOMER_STUDENT_GRADE_11_CNT COMMENT 'Customer STUDENT GRADE 11 CNT from MDR Building view',
	MDR_CUSTOMER_STUDENT_GRADE_12_CNT COMMENT 'Customer STUDENT GRADE 12 CNT from MDR Building view',
	MDR_CUSTOMER_STUDENT_TOTAL_CNT COMMENT 'Customer STUDENT Total CNT from MDR Building view',
	MDR_CUSTOMER_STUDENT_LUNCH_PROGRAM_CNT COMMENT 'Customer STUDENT LUNCH PROGRAM CNT from MDR Building view',
	MDR_CUSTOMER_STUDENT_NATIVE_AMERICAN_CNT COMMENT 'Customer STUDENT NATIVE AMERICAN CNT from MDR Building view',
	MDR_CUSTOMER_STUDENT_ASIAN_CNT COMMENT 'Customer STUDENT ASIAN CNT from MDR Building view',
	MDR_CUSTOMER_STUDENT_HISPANIC_CNT COMMENT 'Customer STUDENT HISPANIC CNT from MDR Building view',
	MDR_CUSTOMER_STUDENT_AFRICAN_AMERICAN_CNT COMMENT 'Customer STUDENT AFRICAN AMERICAN CNT from MDR Building view',
	MDR_CUSTOMER_STUDENT_CAUCASION_CNT COMMENT 'Customer STUDENT CAUCASION CNT from MDR Building view',
	MDR_CUSTOMER_SPECIAL_EDUCATION_ENROLLMENT_CNT COMMENT 'Customer SPECIAL EDUCATION ENROLLMENT CNT from MDR Building view',
	MDR_CUSTOMER_SPECIAL_EDUCATION_ENROLLMENT_PCT COMMENT 'Customer SPECIAL EDUCATION ENROLLMENT PCT from MDR Building view',
	MDR_CUSTOMER_ENGLISH_LANGUAGE_LEARNERS_CNT COMMENT 'Customer ENGLISH LANGUAGE LEARNERS CNT from MDR Building view',
	MDR_CUSTOMER_ENGLISH_LANGUAGE_LEARNERS_PCT COMMENT 'Customer ENGLISH LANGUAGE LEARNERS PCT from MDR Building view',
	MDR_CUSTOMER_SPECIAL_EDUCATION_FUNDING_AMT COMMENT 'Customer SPECIAL EDUCATION FUNDING AMT from MDR Building view',
	MDR_CUSTOMER_BILIGUAL_EDUCATION_FUNDING_AMT COMMENT 'Customer BILIGUAL EDUCATION FUNDING AMT from MDR Building view',
	MDR_CUSTOMER_PARENT_ID COMMENT 'Customer Parent id from MDR Building view',
	MDR_CUSTOMER_PARENT_NAME COMMENT 'Customer Parent Name from MDR Building view',
	MDR_CUSTOMER_ULTIMATE_PARENT_ID COMMENT 'Customer Ultimate Parent id from MDR Building view',
	MDR_CUSTOMER_ULTIMATE_PARENT_NAME COMMENT 'Customer Ultimate Parent Name from MDR Building view',
	MDR_CUSTOMER_DERIVED_PARENT_ID COMMENT 'Customer Derived Parent id from MDR Building view. The highest level of the hierarchy will be shown',
	MDR_CUSTOMER_DERIVED_PARENT_NAME COMMENT 'Customer Derived Parent Name from MDR Building view. The highest level of the hierarchy will be shown'
) COMMENT='Juan Sagasta|MDR Customer list. Used as a base in other enriched views'
 as
SELECT          m.MDR_PID AS MDR_CUSTOMER_ID,
                m.INSTITUTION_NAME AS MDR_CUSTOMER_NAME,
                m.MAILING_ADDRESS_LINE_1 AS MDR_CUSTOMER_ADDRESS,
                m.MAILING_ADDRESS_CITY AS MDR_CUSTOMER_CITY,
                m.COUNTY_NAME AS MDR_CUSTOMER_COUNTY,
                m.MAILING_ADDRESS_STATE AS MDR_CUSTOMER_STATE,
                m.MAILING_ADDRESS_POSTAL_CODE AS MDR_CUSTOMER_ZIPCODE,
                NULL AS MDR_CUSTOMER_COUNTRY,
                
                m.MDR_INSTITUTION_SPECIFICATION AS MDR_CUSTOMER_INSTITUTION_SPECIFICATION,
                m.MDR_INSTITUTION_TYPE AS MDR_CUSTOMER_INSTITUTION_TYPE,
                m.MDR_METRO_CODE AS MDR_CUSTOMER_METRO_CODE,
                m.MDR_INSTITUTION_EDUCATION_LEVEL AS MDR_CUSTOMER_INSTITUTION_EDUCATION_LEVEL,
                m.LATITUDE AS MDR_CUSTOMER_LATITUDE,
                m.LONGITUDE AS MDR_CUSTOMER_LONGITUDE,
                m.STUDENT_TEACHER_RATIO_CNT AS MDR_CUSTOMER_STUDENT_TEACHER_RATIO_COUNT,
                m.ENROLLED_STUDENT_CNT AS MDR_CUSTOMER_ENROLLED_STUDENT_COUNT,
                m.SCHOOL_CLASSROOM_CNT AS MDR_CUSTOMER_SCHOOL_CLASSROOM_COUNT,
                m.MDR_MATERIALS_PER_PUPIL_RNG AS MDR_CUSTOMER_MATERIALS_PER_PUPIL_RNG,
                m.MDR_EXPENDITURE_PER_PUPIL_RNG AS MDR_CUSTOMER_EXPENDITURE_PER_PUPIL_RNG,
                m.INSTRUCTIONAL_MATERIAL_EXPENDITURE_$AMT AS MDR_CUSTOMER_INSTRUCTIONAL_MATERIAL_EXPENDITURE_AMT,
                m.CURRENT_EXPENDITURE_$AMT AS MDR_CUSTOMER_CURRENT_EXPENDITURE_AMT,
                m.MDR_SCHOOL_YEAR_OPENING_RNG AS MDR_CUSTOMER_SCHOOL_YEAR_OPENING_RNG,
                m.MDR_SCHOOL_YEAR_CLOSING_RNG AS MDR_CUSTOMER_SCHOOL_YEAR_CLOSING_RNG,
                m.STUDENT_CAUCASIAN_PCT AS MDR_CUSTOMER_STUDENT_CAUCASIAN_PCT,
                m.STUDENT_AFRICAN_AMERICAN_PCT AS MDR_CUSTOMER_STUDENT_AFRICAN_AMERICAN_PCT,
                m.STUDENT_NATIVE_AMERICAN_PCT AS MDR_CUSTOMER_STUDENT_NATIVE_AMERICAN_PCT,
                m.STUDENT_ASIAN_PCT AS MDR_CUSTOMER_STUDENT_ASIAN_PCT,
                m.STUDENT_HISPANIC_PCT AS MDR_CUSTOMER_STUDENT_HISPANIC_PCT,
                m.MDR_POVERTY_LEVEL_RNG AS MDR_CUSTOMER_POVERTY_LEVEL_RNG,
                m.ACTUAL_POVERTY_PCT AS MDR_CUSTOMER_ACTUAL_POVERTY_PCT,
                m."12TH_GRADE_STUDENT_COLLEGE_BOUND_PCT" AS MDR_CUSTOMER_12TH_GRADE_STUDENT_COLLEGE_BOUND_PCT,
                m.MDR_HOUSEHOLD_INCOME_RNG AS MDR_CUSTOMER_HOUSEHOLD_INCOME_RNG,
                m."CAREER_&_TECH_ED_OFFERED_IND" AS MDR_CUSTOMER_CAREER_AND_TECH_ED_OFFERED_IND,
                m.ADULT_EDUCATION_OFFERED_IND AS MDR_CUSTOMER_ADULT_EDUCATION_OFFERED_IND,
                m.SPECIAL_EDUCATION_OFFERED_IND AS MDR_CUSTOMER_SPECIAL_EDUCATION_OFFERED_IND,
                m.CHARTER_SCHOOL_IND AS MDR_CUSTOMER_CHARTER_SCHOOL_IND,
                m.MAGNET_SCHOOL_OR_PROGRAMS_IND AS MDR_CUSTOMER_MAGNET_SCHOOL_OR_PROGRAMS_IND,
                m.ADV_PLACEMENT_COURSES_OFFERED_IND AS MDR_CUSTOMER_ADV_PLACEMENT_COURSES_OFFERED_IND,
                m.ADV_PLACEMENT_MATH_OFFERED_IND AS MDR_CUSTOMER_ADV_PLACEMENT_MATH_OFFERED_IND,
                m.ADV_PLACEMENT_SCIENCE_OFFERED_IND AS MDR_CUSTOMER_ADV_PLACEMENT_SCIENCE_OFFERED_IND,
                m.ADV_PLACEMENT_SOCIAL_STUDIES_OFFERED_IND AS MDR_CUSTOMER_ADV_PLACEMENT_SOCIAL_STUDIES_OFFERED_IND,
                m.ADV_PLACEMENT_ENGLISH_OFFERED_IND AS MDR_CUSTOMER_ADV_PLACEMENT_ENGLISH_OFFERED_IND,
                m.ADV_PLACEMENT_FINE_ARTS_OFFERED_IND AS MDR_CUSTOMER_ADV_PLACEMENT_FINE_ARTS_OFFERED_IND,
                m.ADV_PLACEMENT_FOREIGN_LANG_OFFERED_IND AS MDR_CUSTOMER_ADV_PLACEMENT_FOREIGN_LANG_OFFERED_IND,
                m.ADV_PLACEMENT_COMP_SCI_OFFERED_IND AS MDR_CUSTOMER_ADV_PLACEMENT_COMP_SCI_OFFERED_IND,
                m.ALTERNATIVE_SCHOOL_OR_PROGRAM_OFFERED AS MDR_CUSTOMER_ALTERNATIVE_SCHOOL_OR_PROGRAM_OFFERED,
                m."BEFORE/AFTER_SCHOOL_PROGRAMS_IND" AS MDR_CUSTOMER_BEFORE_AFTER_SCHOOL_PROGRAMS_IND,
                m.OPEN_YEAR_ROUND_IND AS MDR_CUSTOMER_OPEN_YEAR_ROUND_IND,
                m.BILINGUAL_EDUCATION_IND AS MDR_CUSTOMER_BILINGUAL_EDUCATION_IND,
                m.SUBSTANCE_ABUSE_PROGRAM_OFFERED_IND AS MDR_CUSTOMER_SUBSTANCE_ABUSE_PROGRAM_OFFERED_IND,
                m.CENTER_PROVIDES_MEDIA_SERVICES_IND AS MDR_CUSTOMER_CENTER_PROVIDES_MEDIA_SERVICES_IND,
                m.CENTER_PROVIDES_TECHNOLOGY_SERVICES_IND AS MDR_CUSTOMER_CENTER_PROVIDES_TECHNOLOGY_SERVICES_IND,
                m.SCHOOLWIDE_TITLE_1_PROGRAM_IND AS MDR_CUSTOMER_SCHOOLWIDE_TITLE_1_PROGRAM_IND,
                m.MDR_TITLE_1_$_PER_STUDENT_RNG AS MDR_CUSTOMER_TITLE_1_$_PER_STUDENT_RNG,
                m.TITLE_1_DISTRICT_ALLOCATION_$AMT AS MDR_CUSTOMER_TITLE_1_DISTRICT_ALLOCATION_$AMT,
                m.INSTITUTION_WEB_ADDRESS_URL AS MDR_CUSTOMER_INSTITUTION_WEB_ADDRESS_URL,
                m.CLASSROOM_TEACHER_CNT AS MDR_CUSTOMER_CLASSROOM_TEACHER_CNT,
                m.STUDENT_GRADE_PK_CNT AS MDR_CUSTOMER_STUDENT_GRADE_PK_CNT,
                m.STUDENT_GRADE_K_CNT AS MDR_CUSTOMER_STUDENT_GRADE_K_CNT,
                m.STUDENT_GRADE_1_CNT AS MDR_CUSTOMER_STUDENT_GRADE_1_CNT,
                m.STUDENT_GRADE_2_CNT AS MDR_CUSTOMER_STUDENT_GRADE_2_CNT,
                m.STUDENT_GRADE_3_CNT AS MDR_CUSTOMER_STUDENT_GRADE_3_CNT,
                m.STUDENT_GRADE_4_CNT AS MDR_CUSTOMER_STUDENT_GRADE_4_CNT,
                m.STUDENT_GRADE_5_CNT AS MDR_CUSTOMER_STUDENT_GRADE_5_CNT,
                m.STUDENT_GRADE_6_CNT AS MDR_CUSTOMER_STUDENT_GRADE_6_CNT,
                m.STUDENT_GRADE_7_CNT AS MDR_CUSTOMER_STUDENT_GRADE_7_CNT,
                m.STUDENT_GRADE_8_CNT AS MDR_CUSTOMER_STUDENT_GRADE_8_CNT,
                m.STUDENT_GRADE_9_CNT AS MDR_CUSTOMER_STUDENT_GRADE_9_CNT,
                m.STUDENT_GRADE_10_CNT AS MDR_CUSTOMER_STUDENT_GRADE_10_CNT,
                m.STUDENT_GRADE_11_CNT AS MDR_CUSTOMER_STUDENT_GRADE_11_CNT,
                m.STUDENT_GRADE_12_CNT AS MDR_CUSTOMER_STUDENT_GRADE_12_CNT,
                m.STUDENT_TOTAL_CNT AS MDR_CUSTOMER_STUDENT_TOTAL_CNT,
                m.STUDENT_LUNCH_PROGRAM_CNT AS MDR_CUSTOMER_STUDENT_LUNCH_PROGRAM_CNT,
                m.STUDENT_NATIVE_AMERICAN_CNT AS MDR_CUSTOMER_STUDENT_NATIVE_AMERICAN_CNT,
                m.STUDENT_ASIAN_CNT AS MDR_CUSTOMER_STUDENT_ASIAN_CNT,
                m.STUDENT_HISPANIC_CNT AS MDR_CUSTOMER_STUDENT_HISPANIC_CNT,
                m.STUDENT_AFRICAN_AMERICAN_CNT AS MDR_CUSTOMER_STUDENT_AFRICAN_AMERICAN_CNT,
                m.STUDENT_CAUCASION_CNT AS MDR_CUSTOMER_STUDENT_CAUCASION_CNT,
                m.SPECIAL_EDUCATION_ENROLLMENT_CNT AS MDR_CUSTOMER_SPECIAL_EDUCATION_ENROLLMENT_CNT,
                m.SPECIAL_EDUCATION_ENROLLMENT_PCT AS MDR_CUSTOMER_SPECIAL_EDUCATION_ENROLLMENT_PCT,
                m.ENGLISH_LANGUAGE_LEARNERS_CNT AS MDR_CUSTOMER_ENGLISH_LANGUAGE_LEARNERS_CNT,
                m.ENGLISH_LANGUAGE_LEARNERS_PCT AS MDR_CUSTOMER_ENGLISH_LANGUAGE_LEARNERS_PCT,
                m.SPECIAL_EDUCATION_FUNDING_$AMT AS MDR_CUSTOMER_SPECIAL_EDUCATION_FUNDING_AMT,
                m.BILIGUAL_EDUCATION_FUNDING_$AMT AS MDR_CUSTOMER_BILIGUAL_EDUCATION_FUNDING_AMT,
                m.MDR_PARENT_PID AS MDR_CUSTOMER_PARENT_ID,
                mm.INSTITUTION_NAME AS MDR_CUSTOMER_PARENT_NAME,
                m.MDR_ULTIMATE_PARENT_PID AS MDR_CUSTOMER_ULTIMATE_PARENT_ID,
                mm_ult.INSTITUTION_NAME AS MDR_CUSTOMER_ULTIMATE_PARENT_NAME,
                coalesce( m.MDR_ULTIMATE_PARENT_PID, m.MDR_PARENT_PID, m.MDR_PID) AS MDR_CUSTOMER_DERIVED_PARENT_ID,
                coalesce( mm_ult.INSTITUTION_NAME, mm.INSTITUTION_NAME, m.INSTITUTION_NAME)  AS MDR_CUSTOMER_DERIVED_PARENT_NAME

FROM            DEV_RIVERSIDE_DATA_LAKE.MDR.VW_BUILDING_DECODED m
LEFT OUTER      JOIN DEV_RIVERSIDE_DATA_LAKE.MDR.VW_BUILDING_DECODED mm
                ON mm.MDR_PID = m.MDR_PARENT_PID
LEFT OUTER      JOIN DEV_RIVERSIDE_DATA_LAKE.MDR.VW_BUILDING_DECODED mm_ult
                ON mm_ult.MDR_PID = m.MDR_ULTIMATE_PARENT_PID
;